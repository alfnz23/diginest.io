"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[997],{283:(e,t,i)=>{i.d(t,{A:()=>d,AuthProvider:()=>l});var n=i(8711),o=i(2115),r=i(6772);let a=(0,o.createContext)(void 0),s=[{id:"1",email:"admin@diginest.io",name:"Admin User",isAdmin:!0,purchases:[],joinedAt:"2024-01-01"},{id:"2",email:"customer@example.com",name:"John Doe",isAdmin:!1,purchases:["product-1","product-2"],joinedAt:"2024-02-15"}];function l(e){let{children:t}=e,[i,l]=(0,o.useState)({user:null,isLoading:!0,isAuthenticated:!1});(0,o.useEffect)(()=>{let e=localStorage.getItem("diginest-user");if(e)try{let t=JSON.parse(e);l({user:t,isLoading:!1,isAuthenticated:!0})}catch(e){console.error("Failed to load user from localStorage:",e),l(e=>({...e,isLoading:!1}))}else l(e=>({...e,isLoading:!1}))},[]);let d=async(e,t)=>{l(e=>({...e,isLoading:!0})),await new Promise(e=>setTimeout(e,1e3));let i=s.find(t=>t.email===e);return i&&"password123"===t?(localStorage.setItem("diginest-user",JSON.stringify(i)),l({user:i,isLoading:!1,isAuthenticated:!0}),(0,r.wn)(i),!0):(l(e=>({...e,isLoading:!1})),!1)},u=async(e,t,i)=>{if(l(e=>({...e,isLoading:!0})),await new Promise(e=>setTimeout(e,1e3)),s.find(t=>t.email===e))return l(e=>({...e,isLoading:!1})),!1;let n={id:"user-".concat(Date.now()),email:e,name:i,isAdmin:!1,purchases:[],joinedAt:new Date().toISOString().split("T")[0]};return s.push(n),localStorage.setItem("diginest-user",JSON.stringify(n)),l({user:n,isLoading:!1,isAuthenticated:!0}),(0,r.wn)(n),!0};return(0,n.Y)(a.Provider,{value:{...i,login:d,register:u,logout:()=>{localStorage.removeItem("diginest-user"),l({user:null,isLoading:!1,isAuthenticated:!1})},updateUser:e=>{if(i.user){let t={...i.user,...e};localStorage.setItem("diginest-user",JSON.stringify(t)),l(e=>({...e,user:t}))}}},children:t})}function d(){let e=(0,o.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5323:(e,t,i)=>{i.d(t,{CartProvider:()=>d,_:()=>u});var n=i(8711),o=i(2115);let r={items:[],total:0,itemCount:0};function a(e){return{total:e.reduce((e,t)=>e+t.price*t.quantity,0),itemCount:e.reduce((e,t)=>e+t.quantity,0)}}function s(e,t){switch(t.type){case"ADD_TO_CART":{let i,{total:n,itemCount:o}=a(i=e.items.find(e=>e.id===t.payload.id)?e.items.map(e=>e.id===t.payload.id?{...e,quantity:e.quantity+1}:e):[...e.items,{...t.payload,quantity:1}]);return{items:i,total:n,itemCount:o}}case"REMOVE_FROM_CART":{let i=e.items.filter(e=>e.id!==t.payload),{total:n,itemCount:o}=a(i);return{items:i,total:n,itemCount:o}}case"UPDATE_QUANTITY":{let i=e.items.map(e=>e.id===t.payload.id?{...e,quantity:t.payload.quantity}:e).filter(e=>e.quantity>0),{total:n,itemCount:o}=a(i);return{items:i,total:n,itemCount:o}}case"CLEAR_CART":return r;case"LOAD_CART":{let{total:e,itemCount:i}=a(t.payload);return{items:t.payload,total:e,itemCount:i}}default:return e}}let l=(0,o.createContext)(void 0);function d(e){let{children:t}=e,[i,a]=(0,o.useReducer)(s,r);return(0,o.useEffect)(()=>{let e=localStorage.getItem("diginest-cart");if(e)try{let t=JSON.parse(e);a({type:"LOAD_CART",payload:t})}catch(e){console.error("Failed to load cart from localStorage:",e)}},[]),(0,o.useEffect)(()=>{localStorage.setItem("diginest-cart",JSON.stringify(i.items))},[i.items]),(0,n.Y)(l.Provider,{value:{...i,addToCart:e=>{a({type:"ADD_TO_CART",payload:e})},removeFromCart:e=>{a({type:"REMOVE_FROM_CART",payload:e})},updateQuantity:(e,t)=>{a({type:"UPDATE_QUANTITY",payload:{id:e,quantity:t}})},clearCart:()=>{a({type:"CLEAR_CART"})}},children:t})}function u(){let e=(0,o.useContext)(l);if(void 0===e)throw Error("useCart must be used within a CartProvider");return e}},6772:(e,t,i)=>{i.d(t,{emailAutomation:()=>r,ry:()=>s,wn:()=>a});var n=i(9509);class o{initializeTemplates(){this.templates=[{id:"welcome-1",name:"Welcome Email 1",subject:"Welcome to DigiNest.io! Your journey to productivity starts here \uD83D\uDE80",trigger:{type:"welcome"},delay:0,htmlContent:'\n          <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">\n            <h1 style="color: #1f2937; text-align: center;">Welcome to DigiNest.io!</h1>\n            <p>Hi there,</p>\n            <p>Thank you for joining DigiNest.io! We\'re excited to help you discover amazing digital products that will boost your productivity and creativity.</p>\n\n            <div style="background: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;">\n              <h3 style="color: #1f2937; margin-top: 0;">Get Started:</h3>\n              <ul style="color: #4b5563;">\n                <li>Browse our curated collection of digital planners</li>\n                <li>Check out our bestselling productivity eBooks</li>\n                <li>Join thousands of users who\'ve transformed their workflow</li>\n              </ul>\n            </div>\n\n            <p style="text-align: center;">\n              <a href="/products" style="background: #1f2937; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;">\n                Start Shopping\n              </a>\n            </p>\n\n            <p>Best regards,<br>The DigiNest.io Team</p>\n          </div>\n        '},{id:"welcome-2",name:"Welcome Email 2 - Tips",subject:"Pro tips to get the most out of your digital products \uD83D\uDCA1",trigger:{type:"welcome"},delay:24,htmlContent:'\n          <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">\n            <h1 style="color: #1f2937;">Pro Tips for Digital Product Success</h1>\n            <p>Hi there,</p>\n            <p>Now that you\'re part of the DigiNest.io community, here are some insider tips to maximize your digital products:</p>\n\n            <div style="background: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;">\n              <h3 style="color: #1f2937; margin-top: 0;">\uD83D\uDCA1 Pro Tips:</h3>\n              <ol style="color: #4b5563;">\n                <li><strong>Set up your digital planner:</strong> Import to your favorite app (GoodNotes, Notability, etc.)</li>\n                <li><strong>Create a routine:</strong> Use your planner daily for best results</li>\n                <li><strong>Join our community:</strong> Share your progress and get inspired</li>\n              </ol>\n            </div>\n\n            <p>P.S. Keep an eye out for our weekly productivity tips and exclusive discounts!</p>\n          </div>\n        '},{id:"abandoned-cart",name:"Abandoned Cart Recovery",subject:"You left something amazing in your cart! ✨",trigger:{type:"abandoned_cart"},delay:2,htmlContent:'\n          <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">\n            <h1 style="color: #1f2937;">Don\'t miss out on these great products!</h1>\n            <p>Hi there,</p>\n            <p>We noticed you left some amazing items in your cart. Don\'t worry, we\'ve saved them for you!</p>\n\n            <div style="background: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;">\n              <h3 style="color: #1f2937; margin-top: 0;">Your Cart Items:</h3>\n              <p>Items in your cart</p>\n              <p><strong>Total: $[cart_total]</strong></p>\n            </div>\n\n            <p style="background: #fef3c7; padding: 15px; border-radius: 6px; border-left: 4px solid #f59e0b;">\n              <strong>⏰ Limited Time:</strong> Use code <strong>SAVE10</strong> for 10% off your order!\n            </p>\n\n            <p style="text-align: center;">\n              <a href="/products" style="background: #1f2937; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;">\n                Complete Your Purchase\n              </a>\n            </p>\n          </div>\n        '},{id:"product-recommendations",name:"Product Recommendations",subject:"Handpicked just for you: New arrivals you'll love \uD83C\uDFAF",trigger:{type:"product_recommendation"},delay:0,htmlContent:'\n          <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">\n            <h1 style="color: #1f2937;">Products We Think You\'ll Love</h1>\n            <p>Hi there,</p>\n            <p>Based on your interests, we\'ve handpicked some new arrivals just for you:</p>\n\n            <div style="background: #f3f4f6; padding: 20px; border-radius: 8px; margin: 20px 0;">\n              <p>Recommended products for you</p>\n            </div>\n\n            <p style="text-align: center;">\n              <a href="/products" style="background: #1f2937; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;">\n                Shop Recommendations\n              </a>\n            </p>\n          </div>\n        '}]}async triggerEmail(e,t,i){for(let n of this.templates.filter(t=>t.trigger.type===e)){let o="".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),r=new Date;n.delay&&n.delay>0&&r.setHours(r.getHours()+n.delay);let a={id:o,userId:t,type:e,data:{...i,templateId:n.id},scheduledAt:r,status:"pending"};this.events.push(a),console.log("Email automation scheduled: ".concat(n.name," for user ").concat(t))}}startEventProcessor(){setInterval(()=>{let e=new Date;for(let t of this.events.filter(t=>"pending"===t.status&&t.scheduledAt<=e))this.sendEmail(t)},3e4)}async sendEmail(e){try{let t=this.templates.find(t=>{var i;return t.id===(null==(i=e.data)?void 0:i.templateId)});if(!t){e.status="failed";return}console.log("\uD83D\uDCE7 Sending email: ".concat(t.subject," to user ").concat(e.userId)),await new Promise(e=>setTimeout(e,100)),e.status="sent",e.sentAt=new Date,this.trackEmailEvent(e,t)}catch(t){console.error("Failed to send email:",t),e.status="failed"}}trackEmailEvent(e,t){console.log("\uD83D\uDCCA Email analytics:",{eventId:e.id,userId:e.userId,templateId:t.id,type:e.type,sentAt:e.sentAt,subject:t.subject})}getStats(){let e={totalSent:this.events.filter(e=>"sent"===e.status).length,totalPending:this.events.filter(e=>"pending"===e.status).length,totalFailed:this.events.filter(e=>"failed"===e.status).length,byType:{}};for(let t of this.events)e.byType[t.type]=(e.byType[t.type]||0)+1;return e}cancelEmailsForUser(e,t){for(let i of this.events.filter(i=>i.userId===e&&"pending"===i.status&&(!t||i.type===t)))i.status="cancelled"}constructor(){this.events=[],this.templates=[],this.initializeTemplates(),this.startEventProcessor()}}let r=new o,a=e=>{r.triggerEmail("welcome",e.id,{user_name:e.name,user_email:e.email,site_url:n.env.NEXT_PUBLIC_SITE_URL||"https://diginest.io"})},s=(e,t,i)=>{r.triggerEmail("abandoned_cart",e,{cart_items:t,cart_total:i.toFixed(2),site_url:n.env.NEXT_PUBLIC_SITE_URL||"https://diginest.io"})}}}]);